#!/usr/local/bin/xs -f
// vim: et ts=4 sw=4 ft=ron
Script([
    Let ("Edit-Script",
        Expr (r####"
            Script([
                Exec (output: Display,
                    cmd: "fish",
                    args: [
                        "--init-command",
                        "source etc/env/dev.fish"
                    ],
                ),
            ])
        "####)
    ),

    Exec (output: Display,
        cmd: "tmux",
        args: [
            "new-session", "-A",
                "-n", "Edit",
                "-s", "ct",
                "xs", "-c", (var: "Edit-Script"),
            ";",
            "split-window", "-h",
                "-t", "ct:Edit.0",
                "-d",
                "xs", "-f", "dev_exec/::sanctioned/dev:entr.loop",
            ";",
            "split-window", "-h", "-b",
                "-t", "ct:Edit.0",
                "-d",
                "xs", "--error-server",
            ";",
            "split-window", "-v",
                "-t", "ct:Edit.0",
                "-l", "10",
                "-d",
                "xs", "-c", r####"Script([
                    Exec (output: Display,
                        cmd: "darkhttpd",
                        args: [".", "--addr", "0.0.0.0", "--port", "5001"],
                        cwd: Some("_.artifact"),
                    )
                ])"####,
            ";",
            "resize-pane",
                "-t", "ct:Edit.0",
                "-x", "23%",
            ";",
            "resize-pane",
                "-t", "ct:Edit.3",
                "-x", "23%",
            ";",
            "set-option",
                "-t", "ct:Edit.3",
                "remain-on-exit", "on",
            ";",
        ],
    ),
])//Script
